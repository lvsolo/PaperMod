---
title: "Center-based 3D Object Detection and Tracking"
date: "2024-11-07T18:00:00+08:00"
author: "lvsolo"
---
[paper](https://readpaper.com/pdf-annotate/note?pdfId=4545076807438327809&noteId=2569501418004823040)

本文主要介绍了一种提高单阶段物体检测器定位精度的方法——基于IoU的单阶段物体检测器。该方法通过预测每个检测框的IoU值，将预测的IoU值乘以分类得分来计算最终的检测置信度。此置信度与定位精度更相关，可以解决分类得分和定位精度之间的低相关性问题，从而大大提高模型的定位精度。


在论文中，IoU-aware单阶段目标检测器的操作步骤如下：
模型架构设计：

该模型主要基于RetinaNet进行修改，保留了相同的骨干网络和特征金字塔网络（FPN）。
在回归分支的最后一层添加了一个与回归头平行的IoU预测头，用于预测每个检测框的IoU。
IoU预测头由一个3*3的卷积层和一个sigmoid激活层组成，以确保预测的IoU值在[0, 1]范围内。
训练过程：

使用焦点损失（focal loss）作为分类损失，平滑L1损失作为回归损失。
使用二元交叉熵损失（BCE）作为IoU预测损失，仅对正样本计算损失。
IoU预测头与分类头和回归头联合训练。
在训练过程中，计算IoU预测损失相对于目标IoU的梯度，这有助于将梯度反向传播到回归头，从而指导回归头预测更准确的边界框。
推理过程：

在推理时，通过将分类分数与预测的IoU相乘来计算每个检测框的最终检测置信度。
参数α用于控制分类分数和预测IoU对最终检测置信度的贡献。
使用计算得到的检测置信度对所有检测框进行排序，并在后续的非极大值抑制（NMS）和AP计算中使用。
通过这种方式，分类分数和定位精度之间的不匹配问题得到缓解，从而显著提高了模型的定位精度。
总结来说，IoU-aware单阶段目标检测器通过在模型中引入IoU预测头，并在训练和推理过程中结合分类分数和预测的IoU来计算最终的检测置信度，从而提高了模型的定位精度。

IoU预测头的gt（ground truth）是目标IoU（ÎoU i），它是通过计算回归的正样本框（b i）与对应的ground truth框之间的IoU来得到的。具体来说，目标IoU是预测框与ground truth框之间的交并比（IoU），用于在训练过程中作为IoU预测头的监督信号。
这个gt（目标IoU）是一直在变化的。在每个iteration中，网络会根据当前的预测值生成预测框，然后计算这些预测框与ground truth框之间的IoU，这个IoU值会被用作IoU预测头的gt（目标IoU）。具体来说，目标IoU是通过计算回归的正样本框（b i）与对应的ground truth框之间的IoU来得到的，这个值会在训练过程中作为IoU预测头的监督信号，帮助网络学习如何更准确地预测IoU。

